<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title></title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
  <style type="text/css">
    .atsyntax {color:#E80000;background-color:#E0E0E0}
    .atsyntax span.comment {color:#787878;font-style:italic}
    .atsyntax span.extern  {color:#A52A2A}
    .atsyntax span.keyword {color:#000000;font-weight:bold}
    .atsyntax span.neuexp  {color:#800080}
    .atsyntax span.staexp  {color:#0000FF}
    .atsyntax span.dynexp  {color:#E80000}
    .atsyntax span.prfexp  {color:#009000}
    .atsyntax span.stacstdec  {text-decoration:none}
    .atsyntax span.stacstuse  {color:#0000CF;text-decoration:underline}
    .atsyntax span.dyncstdec  {text-decoration:none}
    .atsyntax span.dyncstimp  {color:#B80000;text-decoration:underline}
    .atsyntax span.dyncstuse  {color:#B80000;text-decoration:underline}
    body {color:#E80000;background-color:#E0E0E0}
  </style>
</head>
<body>
<pre class="atsyntax">

<span class="keyword">staload</span> <span class="staexp">"libfunctions.sats"</span>
<span class="keyword">staload</span> <span class="staexp">"absyn.sats"</span>
<span class="keyword">staload</span> <span class="staexp">"trans1.sats"</span>
<span class="keyword">staload</span> <span class="staexp">"symbol.sats"</span>

<span class="keyword">staload</span> <span class="staexp">_<span class="comment">(*anon*)</span> <span class="keyword">=</span> "prelude/DATS/reference.dats"</span>
<span class="keyword">staload</span> <span class="staexp">_<span class="comment">(*anon*)</span> <span class="keyword">=</span> "symbol.dats"</span>

<span class="keyword">typedef</span> <span class="staexp"><a name="188"><span class="stacstdec">sym <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#88"><span class="stacstuse">symbol_t</span></a></span></a></span>

<span class="keyword">#define</span> <span class="neuexp">:: list0_cons</span><span class="keyword">;</span> <span class="keyword">#define</span> <span class="neuexp">nil list0_nil</span>

<span class="keyword">#define</span> <span class="neuexp">Some0 option0_some</span>
<span class="keyword">#define</span> <span class="neuexp">None0 option0_none</span>

<span class="comment">(* ******** *********** *)</span>

<span class="keyword">implement</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2flibfunctions_2esats.html#420"><span class="dyncstimp">symbol_LIST_CONS</span></a> <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#222"><span class="dyncstuse">symbol_make_name</span></a> "list_cons"
<span class="keyword">implement</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2flibfunctions_2esats.html#367"><span class="dyncstimp">symbol_LIST_NIL</span></a> <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#222"><span class="dyncstuse">symbol_make_name</span></a> "list_nil"
<span class="keyword">implement</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2flibfunctions_2esats.html#475"><span class="dyncstimp">symbol_LIST_IS_EMPTY</span></a> <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#222"><span class="dyncstuse">symbol_make_name</span></a> "list_is_empty"
<span class="keyword">implement</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2flibfunctions_2esats.html#538"><span class="dyncstimp">symbol_LIST_HEAD</span></a> <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#222"><span class="dyncstuse">symbol_make_name</span></a> "list_head"
<span class="keyword">implement</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2flibfunctions_2esats.html#593"><span class="dyncstimp">symbol_LIST_TAIL</span></a> <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#222"><span class="dyncstuse">symbol_make_name</span></a> "list_tail"

<span class="keyword">implement</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2flibfunctions_2esats.html#649"><span class="dyncstimp">symbol_STRING_ADD</span></a> <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#222"><span class="dyncstuse">symbol_make_name</span></a> "string_add"

<span class="keyword">abstype</span> <span class="staexp"><a name="699"><span class="stacstdec">theConstTypMap_t</span></a></span>

<span class="keyword">extern</span> <span class="keyword">fun</span> <a name="728"><span class="dyncstdec">ConstTypMapFind <span class="keyword">(</span>nam<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2flibfunctions_2edats.html#188"><span class="stacstuse">sym</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fbasics_5fsta_2esats.html#22670"><span class="stacstuse">option0</span></a> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#258"><span class="stacstuse">t1yp</span></a></span></span></a>

<span class="keyword">local</span>

<span class="keyword">assume</span> <span class="staexp">theConstTypMap_t <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#1634"><span class="stacstuse">symenv_t</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#258"><span class="stacstuse">t1yp</span></a><span class="keyword">)</span></span>

<span class="keyword">macdef</span> <span class="neuexp">list0_sing <span class="keyword">(</span>x<span class="keyword">)</span> <span class="keyword">=</span> list0_cons <span class="keyword">(</span><span class="keyword">,(</span>x<span class="keyword">)</span><span class="keyword">,</span> list0_nil <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span></span>

<span class="keyword">val</span> theConstTypMap <span class="keyword">=</span>
  res <span class="keyword">where</span> <span class="keyword">{</span>
  <span class="keyword">val</span> t1yp_int1 <span class="keyword">=</span> T1YPtup <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#875"><span class="dyncstuse">t1yp_int</span></a> :: nil<span class="keyword">)</span>
  <span class="keyword">val</span> t1yp_int2 <span class="keyword">=</span> T1YPtup <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#875"><span class="dyncstuse">t1yp_int</span></a> :: <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#875"><span class="dyncstuse">t1yp_int</span></a> :: nil<span class="keyword">)</span>
  <span class="keyword">val</span> t1yp_str1 <span class="keyword">=</span> T1YPtup <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#894"><span class="dyncstuse">t1yp_string</span></a> :: nil<span class="keyword">)</span>
  <span class="keyword">val</span> t1yp_str2 <span class="keyword">=</span> T1YPtup <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#894"><span class="dyncstuse">t1yp_string</span></a> :: <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#894"><span class="dyncstuse">t1yp_string</span></a> :: nil<span class="keyword">)</span>
  <span class="keyword">val</span> t1yp_aop <span class="keyword">=</span> T1YPfun <span class="keyword">(</span><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fSATS_2freference_2esats.html#2079"><span class="dyncstuse">ref_make_elt&lt;</span></a><span class="staexp"><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15585"><span class="stacstuse">int</span></a></span><span class="keyword">&gt;</span> <span class="keyword">(</span>2<span class="keyword">)</span><span class="keyword">,</span> t1yp_int2<span class="keyword">,</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#875"><span class="dyncstuse">t1yp_int</span></a><span class="keyword">)</span>
  <span class="keyword">val</span> t1yp_bop <span class="keyword">=</span> T1YPfun <span class="keyword">(</span><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fSATS_2freference_2esats.html#2079"><span class="dyncstuse">ref_make_elt&lt;</span></a><span class="staexp"><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15585"><span class="stacstuse">int</span></a></span><span class="keyword">&gt;</span> <span class="keyword">(</span>2<span class="keyword">)</span><span class="keyword">,</span> t1yp_int2<span class="keyword">,</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#855"><span class="dyncstuse">t1yp_bool</span></a><span class="keyword">)</span>
  <span class="keyword">typedef</span> <span class="staexp"><a name="1272"><span class="stacstdec">T <span class="keyword">=</span> <span class="keyword">@(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2flibfunctions_2edats.html#188"><span class="stacstuse">sym</span></a><span class="keyword">,</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#258"><span class="stacstuse">t1yp</span></a><span class="keyword">)</span></span></a></span>
  <span class="keyword">val</span> cts <span class="keyword">=</span> <span class="keyword">(</span>
    <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#1183"><span class="dyncstuse">symbol_PLUS</span></a><span class="keyword">,</span> t1yp_aop<span class="keyword">)</span> ::
    <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#1217"><span class="dyncstuse">symbol_MINUS</span></a><span class="keyword">,</span> t1yp_aop<span class="keyword">)</span> ::
    <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#1252"><span class="dyncstuse">symbol_TIMES</span></a><span class="keyword">,</span> t1yp_aop<span class="keyword">)</span> ::
    <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#1287"><span class="dyncstuse">symbol_SLASH</span></a><span class="keyword">,</span> t1yp_aop<span class="keyword">)</span> ::
    <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#1146"><span class="dyncstuse">symbol_UMINUS</span></a><span class="keyword">,</span> T1YPfun <span class="keyword">(</span><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fSATS_2freference_2esats.html#2079"><span class="dyncstuse">ref_make_elt&lt;</span></a><span class="staexp"><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15585"><span class="stacstuse">int</span></a></span><span class="keyword">&gt;</span> <span class="keyword">(</span>1<span class="keyword">)</span><span class="keyword">,</span> t1yp_int1<span class="keyword">,</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#875"><span class="dyncstuse">t1yp_int</span></a><span class="keyword">)</span><span class="keyword">)</span> ::
    <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#1323"><span class="dyncstuse">symbol_GT</span></a><span class="keyword">,</span> t1yp_bop<span class="keyword">)</span> ::
    <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#1355"><span class="dyncstuse">symbol_GTE</span></a><span class="keyword">,</span> t1yp_bop<span class="keyword">)</span> ::
    <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#1389"><span class="dyncstuse">symbol_LT</span></a><span class="keyword">,</span> t1yp_bop<span class="keyword">)</span> ::
    <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#1421"><span class="dyncstuse">symbol_LTE</span></a><span class="keyword">,</span> t1yp_bop<span class="keyword">)</span> ::
    <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#1455"><span class="dyncstuse">symbol_EQ</span></a><span class="keyword">,</span> t1yp_bop<span class="keyword">)</span> ::
    <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#1487"><span class="dyncstuse">symbol_NEQ</span></a><span class="keyword">,</span> t1yp_bop<span class="keyword">)</span> ::
    <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#1561"><span class="dyncstuse">symbol_PRINT_INT</span></a><span class="keyword">,</span> T1YPfun <span class="keyword">(</span><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fSATS_2freference_2esats.html#2079"><span class="dyncstuse">ref_make_elt&lt;</span></a><span class="staexp"><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15585"><span class="stacstuse">int</span></a></span><span class="keyword">&gt;</span> <span class="keyword">(</span>1<span class="keyword">)</span><span class="keyword">,</span> t1yp_int1<span class="keyword">,</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#916"><span class="dyncstuse">t1yp_unit</span></a><span class="keyword">)</span><span class="keyword">)</span> ::
    <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#1522"><span class="dyncstuse">symbol_PRINT</span></a><span class="keyword">,</span> T1YPfun <span class="keyword">(</span><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fSATS_2freference_2esats.html#2079"><span class="dyncstuse">ref_make_elt&lt;</span></a><span class="staexp"><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15585"><span class="stacstuse">int</span></a></span><span class="keyword">&gt;</span> <span class="keyword">(</span>1<span class="keyword">)</span><span class="keyword">,</span> t1yp_str1<span class="keyword">,</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#916"><span class="dyncstuse">t1yp_unit</span></a><span class="keyword">)</span><span class="keyword">)</span> ::
    <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2flibfunctions_2esats.html#649"><span class="dyncstuse">symbol_STRING_ADD</span></a><span class="keyword">,</span> T1YPfun <span class="keyword">(</span><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fSATS_2freference_2esats.html#2079"><span class="dyncstuse">ref_make_elt&lt;</span></a><span class="staexp"><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15585"><span class="stacstuse">int</span></a></span><span class="keyword">&gt;</span> <span class="keyword">(</span>2<span class="keyword">)</span><span class="keyword">,</span> t1yp_str2<span class="keyword">,</span> t1yp_str1<span class="keyword">)</span><span class="keyword">)</span> ::
    nil <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fbasics_5fsta_2esats.html#22196"><span class="stacstuse">list0</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2flibfunctions_2edats.html#1272"><span class="stacstuse">T</span></a><span class="keyword">)</span></span> <span class="comment">// end of [val]
</span>  <span class="keyword">val</span> res<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2flibfunctions_2edats.html#699"><span class="stacstuse">theConstTypMap_t</span></a></span> <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#1668"><span class="dyncstuse">symenv_make</span></a> <span class="keyword">(</span><span class="keyword">)</span>
  <span class="keyword">fun</span> loop <span class="keyword">(</span>
    cts<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fbasics_5fsta_2esats.html#22196"><span class="stacstuse">list0</span></a> <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2flibfunctions_2edats.html#1272"><span class="stacstuse">T</span></a><span class="keyword">)</span></span><span class="keyword">,</span> res<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2flibfunctions_2edats.html#699"><span class="stacstuse">theConstTypMap_t</span></a></span>
  <span class="keyword">)</span> <span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2flibfunctions_2edats.html#699"><span class="stacstuse">theConstTypMap_t</span></a></span> <span class="keyword">=</span>
    <span class="keyword">case+</span> cts <span class="keyword">of</span>
    <span class="keyword">|</span> ct :: cts <span class="keyword">=&gt;</span> <span class="keyword">let</span>
        <span class="keyword">val</span> res<span class="comment">(*_already*)</span> <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#1783"><span class="dyncstuse">symenv_insert</span></a> <span class="keyword">(</span>res<span class="keyword">,</span> ct<span class="keyword">.</span>0<span class="keyword">,</span> ct<span class="keyword">.</span>1<span class="keyword">)</span> <span class="keyword">in</span> loop <span class="keyword">(</span>cts<span class="keyword">,</span> res<span class="keyword">)</span>
      <span class="keyword">end</span> <span class="comment">// end of [::]
</span>    <span class="keyword">|</span> nil <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> res
  <span class="comment">// end of [loop]  
</span>  <span class="keyword">val</span> res <span class="keyword">=</span> loop <span class="keyword">(</span>cts<span class="keyword">,</span> res<span class="keyword">)</span>
<span class="keyword">}</span> <span class="comment">// end of [val]
</span>
<span class="keyword">in</span> <span class="comment">// in of [local]
</span>
<span class="keyword">fun</span> ConstTypMapFind <span class="keyword">(</span>nam<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2flibfunctions_2edats.html#188"><span class="stacstuse">sym</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fbasics_5fsta_2esats.html#22670"><span class="stacstuse">option0</span></a> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#258"><span class="stacstuse">t1yp</span></a></span> <span class="keyword">=</span>
  <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2fsymbol_2esats.html#1711"><span class="dyncstuse">symenv_lookup&lt;</span></a><span class="staexp"><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#258"><span class="stacstuse">t1yp</span></a></span><span class="keyword">&gt;</span> <span class="keyword">(</span>theConstTypMap<span class="keyword">,</span> nam<span class="keyword">)</span>
<span class="comment">// end of [theConstTypFind]
</span>
<span class="keyword">end</span> <span class="comment">// end of [local]
</span>
<span class="keyword">implement</span>
<a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2flibfunctions_2esats.html#1559"><span class="dyncstimp">libOprTypFind</span></a> <span class="keyword">(</span>opr<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val+</span> OPR sym <span class="keyword">=</span> opr
<span class="keyword">in</span>
  ConstTypMapFind <span class="keyword">(</span>sym<span class="keyword">)</span>
<span class="keyword">end</span>  <span class="comment">// end of [libOprTypFind]
</span>
<span class="keyword">fun</span> constructorTypFind <span class="keyword">(</span>fname<span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2flibfunctions_2edats.html#188"><span class="stacstuse">sym</span></a></span><span class="keyword">)</span><span class="keyword">:</span> <span class="staexp"><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fbasics_5fsta_2esats.html#22670"><span class="stacstuse">option0</span></a> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#258"><span class="stacstuse">t1yp</span></a></span> <span class="keyword">=</span>
  <span class="keyword">case+</span> 0 <span class="keyword">of</span>
  <span class="keyword">|</span> _ <span class="keyword">when</span> fname <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2flibfunctions_2esats.html#420"><span class="dyncstuse">symbol_LIST_CONS</span></a> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
    <span class="comment">// list_cons (x: X, xs: list X): list X
</span>    <span class="keyword">val</span> t1var <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#717"><span class="dyncstuse">t1Var_new</span></a> <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#810"><span class="dyncstuse">t1Var_set_typ</span></a> <span class="keyword">(</span>t1var<span class="keyword">,</span> T1YPvar <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#717"><span class="dyncstuse">t1Var_new</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">val</span> X <span class="keyword">=</span> T1YPvar <span class="keyword">(</span>t1var<span class="keyword">)</span>
    <span class="keyword">val</span> listX <span class="keyword">=</span> T1YPlist <span class="keyword">(</span>t1var<span class="keyword">)</span>
    <span class="keyword">val</span> args <span class="keyword">=</span> X :: listX :: nil
  <span class="keyword">in</span>
    Some0 <span class="keyword">(</span>T1YPfun <span class="keyword">(</span><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fSATS_2freference_2esats.html#2079"><span class="dyncstuse">ref_make_elt&lt;</span></a><span class="staexp"><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15585"><span class="stacstuse">int</span></a></span><span class="keyword">&gt;</span> <span class="keyword">(</span>2<span class="keyword">)</span><span class="keyword">,</span> T1YPtup <span class="keyword">(</span>args<span class="keyword">)</span><span class="keyword">,</span> listX<span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">end</span>
  <span class="keyword">|</span> _ <span class="keyword">when</span> fname <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2flibfunctions_2esats.html#367"><span class="dyncstuse">symbol_LIST_NIL</span></a> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
    <span class="comment">// list_nil (): list X
</span>    <span class="keyword">val</span> t1var <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#717"><span class="dyncstuse">t1Var_new</span></a> <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#810"><span class="dyncstuse">t1Var_set_typ</span></a> <span class="keyword">(</span>t1var<span class="keyword">,</span> T1YPvar <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#717"><span class="dyncstuse">t1Var_new</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">val</span> listX <span class="keyword">=</span> T1YPlist <span class="keyword">(</span>t1var<span class="keyword">)</span>
  <span class="keyword">in</span>
    Some0 <span class="keyword">(</span>T1YPfun <span class="keyword">(</span><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fSATS_2freference_2esats.html#2079"><span class="dyncstuse">ref_make_elt&lt;</span></a><span class="staexp"><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15585"><span class="stacstuse">int</span></a></span><span class="keyword">&gt;</span> <span class="keyword">(</span>0<span class="keyword">)</span><span class="keyword">,</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#916"><span class="dyncstuse">t1yp_unit</span></a><span class="keyword">,</span> listX<span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">end</span>
  <span class="keyword">|</span> _ <span class="keyword">when</span> fname <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2flibfunctions_2esats.html#475"><span class="dyncstuse">symbol_LIST_IS_EMPTY</span></a> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
    <span class="comment">// list_is_empty (xs: list X): bool
</span>    <span class="keyword">val</span> t1var <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#717"><span class="dyncstuse">t1Var_new</span></a> <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#810"><span class="dyncstuse">t1Var_set_typ</span></a> <span class="keyword">(</span>t1var<span class="keyword">,</span> T1YPvar <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#717"><span class="dyncstuse">t1Var_new</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">val</span> listX <span class="keyword">=</span> T1YPlist <span class="keyword">(</span>t1var<span class="keyword">)</span>
  <span class="keyword">in</span>
    Some0 <span class="keyword">(</span>T1YPfun <span class="keyword">(</span><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fSATS_2freference_2esats.html#2079"><span class="dyncstuse">ref_make_elt&lt;</span></a><span class="staexp"><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15585"><span class="stacstuse">int</span></a></span><span class="keyword">&gt;</span> <span class="keyword">(</span>1<span class="keyword">)</span><span class="keyword">,</span> listX<span class="keyword">,</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#855"><span class="dyncstuse">t1yp_bool</span></a><span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">end</span>
  <span class="keyword">|</span> _ <span class="keyword">when</span> fname <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2flibfunctions_2esats.html#538"><span class="dyncstuse">symbol_LIST_HEAD</span></a> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
    <span class="comment">// list_head (xs: list X): X
</span>    <span class="keyword">val</span> t1var <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#717"><span class="dyncstuse">t1Var_new</span></a> <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#810"><span class="dyncstuse">t1Var_set_typ</span></a> <span class="keyword">(</span>t1var<span class="keyword">,</span> T1YPvar <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#717"><span class="dyncstuse">t1Var_new</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">val</span> X <span class="keyword">=</span> T1YPvar <span class="keyword">(</span>t1var<span class="keyword">)</span>
    <span class="keyword">val</span> listX <span class="keyword">=</span> T1YPlist <span class="keyword">(</span>t1var<span class="keyword">)</span>
  <span class="keyword">in</span>
    Some0 <span class="keyword">(</span>T1YPfun <span class="keyword">(</span><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fSATS_2freference_2esats.html#2079"><span class="dyncstuse">ref_make_elt&lt;</span></a><span class="staexp"><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15585"><span class="stacstuse">int</span></a></span><span class="keyword">&gt;</span> <span class="keyword">(</span>1<span class="keyword">)</span><span class="keyword">,</span> listX<span class="keyword">,</span> X<span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">end</span>
  <span class="keyword">|</span> _ <span class="keyword">when</span> fname <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2flibfunctions_2esats.html#593"><span class="dyncstuse">symbol_LIST_TAIL</span></a> <span class="keyword">=&gt;</span> <span class="keyword">let</span>
    <span class="comment">// list_tail (xs: list X): list X
</span>    <span class="keyword">val</span> t1var <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#717"><span class="dyncstuse">t1Var_new</span></a> <span class="keyword">(</span><span class="keyword">)</span>
    <span class="keyword">val</span> <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#810"><span class="dyncstuse">t1Var_set_typ</span></a> <span class="keyword">(</span>t1var<span class="keyword">,</span> T1YPvar <span class="keyword">(</span><a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2ftrans1_2esats.html#717"><span class="dyncstuse">t1Var_new</span></a> <span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span>
    <span class="keyword">val</span> listX <span class="keyword">=</span> T1YPlist <span class="keyword">(</span>t1var<span class="keyword">)</span>
  <span class="keyword">in</span>
    Some0 <span class="keyword">(</span>T1YPfun <span class="keyword">(</span><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fSATS_2freference_2esats.html#2079"><span class="dyncstuse">ref_make_elt&lt;</span></a><span class="staexp"><a href="XREF/_2fscratch_2fprograms_2fats_5ftrunk_2fprelude_2fbasics_5fsta_2esats.html#15585"><span class="stacstuse">int</span></a></span><span class="keyword">&gt;</span> <span class="keyword">(</span>1<span class="keyword">)</span><span class="keyword">,</span> listX<span class="keyword">,</span> listX<span class="keyword">)</span><span class="keyword">)</span>
  <span class="keyword">end</span>
  <span class="keyword">|</span> _ <span class="keyword">=&gt;</span> None0 <span class="keyword">(</span><span class="keyword">)</span>

<span class="comment">(* ****** ****** *)</span>

<span class="comment">(* fun libSymTypFind (nam: $Symbol.symbol_t): option0 $Trans1.t1yp *)</span>
<span class="keyword">implement</span> <a href="XREF/_2fhome_2fgrad2_2faren_2fcourses_2fcs525_5fCompiler_2fassignment02_2flibfunctions_2esats.html#1495"><span class="dyncstimp">libSymTypFind</span></a> <span class="keyword">(</span>nam<span class="keyword">)</span> <span class="keyword">=</span> <span class="keyword">let</span>
  <span class="keyword">val</span> t1yp_opt <span class="keyword">=</span> ConstTypMapFind <span class="keyword">(</span>nam<span class="keyword">)</span>
<span class="keyword">in</span>
  <span class="keyword">case+</span> t1yp_opt <span class="keyword">of</span>
  <span class="keyword">|</span> Some0 _ <span class="keyword">=&gt;</span> t1yp_opt
  <span class="keyword">|</span> None0 <span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">=&gt;</span> constructorTypFind <span class="keyword">(</span>nam<span class="keyword">)</span>
<span class="keyword">end</span>













</pre>
</body>
</html>
